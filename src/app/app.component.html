@defer {
  <app-header></app-header>
  <app-side-bar></app-side-bar>
  <app-settings></app-settings>

  <div class="center">
    <div class="center-canvas">
      @switch (appStateService.layoutState().mainAreaContent) {
        @case (MainAreaContent.CANVAS) {
          <app-canvas></app-canvas>
        }
        @case (MainAreaContent.PREVIEW) {
          @defer (on viewport) {
            <app-preview></app-preview>
          } @placeholder {
            <div>loading...</div>
          }
        }
        @case (MainAreaContent.CODE) {
          @defer (on viewport) {
            <ng-container *ngTemplateOutlet="codeLayout"></ng-container>
          } @placeholder {
            <div>loading...</div>
          }
        }
      }
    </div>
  </div>

  <p-toast position="bottom-center"></p-toast>

} @placeholder (minimum 0.2s) {
  <div class="loader-wrapper">
    <div class="branding">
      <img
        src="https://img.icons8.com/external-flatart-icons-flat-flatarticons/512/external-layout-user-interface-flatart-icons-flat-flatarticons-1.png"
        alt="loading...">
    </div>
    <div class="branding-name"><span class="loader">unboxing boxOut</span></div>
  </div>
}

<router-outlet></router-outlet>

<ng-template #codeLayout>
  @switch (appStateService.layoutState().sideBarSecondary) {
    @case (SideBarSecondary.HTML) {
      <app-html-prism></app-html-prism>
    }
    @case (SideBarSecondary.JSON) {
      <app-json-prism></app-json-prism>
    }
    @case (SideBarSecondary.CSS) {
      <app-css-prism [canvasItems]="canvasService.items"></app-css-prism>
    }
  }
</ng-template>
