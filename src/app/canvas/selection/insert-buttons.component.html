<div class="insert-buttons">
  <!-- Before Button -->
  <button
    class="insert-action-btn"
    (click)="onQuickInsert(insertPositionEnum.BEFORE, $event)"
    (contextmenu)="onShowAssetsMenu(insertPositionEnum.BEFORE, $event, assetsMenuBefore)"
    pTooltip="Insert Before"
    tooltipPosition="left"
    [showDelay]="500"
    [attr.aria-label]="'Insert before ' + canvasItem()?.label">
    <i class="pi pi-angle-up"></i>
  </button>

  <!-- Inside Button - Only show for containers -->
  @if (canvasItem()?.itemType === 'FLEX' || canvasItem()?.itemType === 'GRID') {
    <button
      class="insert-action-btn"
      (click)="onQuickInsert(insertPositionEnum.INSIDE, $event)"
      (contextmenu)="onShowAssetsMenu(insertPositionEnum.INSIDE, $event, assetsMenuInside)"
      pTooltip="Insert Inside"
      tooltipPosition="left"
      [showDelay]="500"
      [attr.aria-label]="'Insert inside ' + canvasItem()?.label">
      <i class="pi pi-plus"></i>
    </button>
  }

  <!-- After Button -->
  <button
    class="insert-action-btn"
    (click)="onQuickInsert(insertPositionEnum.AFTER, $event)"
    (contextmenu)="onShowAssetsMenu(insertPositionEnum.AFTER, $event, assetsMenuAfter)"
    pTooltip="Insert After"
    tooltipPosition="left"
    [showDelay]="500"
    [attr.aria-label]="'Insert after ' + canvasItem()?.label">
    <i class="pi pi-angle-down"></i>
  </button>
</div>

<!-- Assets Menu Popovers -->
<p-popover #assetsMenuBefore>
  <div class="assets-menu">
    <button class="asset-menu-item primary" (click)="onInsertAsset('empty-flex', insertPositionEnum.BEFORE); assetsMenuBefore.hide()">
      <i class="pi pi-box"></i>
      <span>Empty Flex</span>
    </button>
    <button class="asset-menu-item" (click)="onInsertAsset('text', insertPositionEnum.BEFORE); assetsMenuBefore.hide()">
      <i class="pi pi-align-left"></i>
      <span>Text</span>
    </button>
    <div class="menu-divider"></div>
    <button class="asset-menu-item secondary" (click)="onShowFullAssets(insertPositionEnum.BEFORE, assetsMenuBefore, fullAssetsPopover)">
      <i class="pi pi-th-large"></i>
      <span>All Assets</span>
    </button>
  </div>
</p-popover>

<p-popover #assetsMenuInside>
  <div class="assets-menu">
    <button class="asset-menu-item primary" (click)="onInsertAsset('empty-flex', insertPositionEnum.INSIDE); assetsMenuInside.hide()">
      <i class="pi pi-box"></i>
      <span>Empty Flex</span>
    </button>
    <button class="asset-menu-item" (click)="onInsertAsset('text', insertPositionEnum.INSIDE); assetsMenuInside.hide()">
      <i class="pi pi-align-left"></i>
      <span>Text</span>
    </button>
    <div class="menu-divider"></div>
    <button class="asset-menu-item secondary" (click)="onShowFullAssets(insertPositionEnum.INSIDE, assetsMenuInside, fullAssetsPopover)">
      <i class="pi pi-th-large"></i>
      <span>All Assets</span>
    </button>
  </div>
</p-popover>

<p-popover #assetsMenuAfter>
  <div class="assets-menu">
    <button class="asset-menu-item primary" (click)="onInsertAsset('empty-flex', insertPositionEnum.AFTER); assetsMenuAfter.hide()">
      <i class="pi pi-box"></i>
      <span>Empty Flex</span>
    </button>
    <button class="asset-menu-item" (click)="onInsertAsset('text', insertPositionEnum.AFTER); assetsMenuAfter.hide()">
      <i class="pi pi-align-left"></i>
      <span>Text</span>
    </button>
    <div class="menu-divider"></div>
    <button class="asset-menu-item secondary" (click)="onShowFullAssets(insertPositionEnum.AFTER, assetsMenuAfter, fullAssetsPopover)">
      <i class="pi pi-th-large"></i>
      <span>All Assets</span>
    </button>
  </div>
</p-popover>

<!-- Full Assets Popover -->
<p-popover #fullAssetsPopover>
  <app-insert
    [parentFrameId]="canvasItem()?.key"
    [insertPosition]="currentInsertPosition"
    (componentAdded)="fullAssetsPopover.hide()">
  </app-insert>
</p-popover>
