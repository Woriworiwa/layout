@if (item().aiMetadata) {
  <!-- AI Wrapper -->
  <app-ai-wrapper [item]="item()">
    <ng-container
      *ngTemplateOutlet="
        contentRenderer;
        context: { $implicit: item().children }
      "
    ></ng-container>
  </app-ai-wrapper>
} @else {
  <!-- Regular Container -->
  @switch (item().itemType) {
    @case (FrameType.FLEX) {
      <ng-container
        *ngTemplateOutlet="
          contentRenderer;
          context: { $implicit: item().children }
        "
      ></ng-container>
    }
    @case (FrameType.TEXT) {
      <!-- render text-->
      <ng-container
        *ngTemplateOutlet="text; context: { $implicit: item() }"
      ></ng-container>
    }
  }
}

<!-- content renderer -->
<ng-template #contentRenderer let-items>
  @for (item of items; track item.key) {
    @switch (item.itemType) {
      @case (FrameType.FLEX) {
        <ng-template
          *ngTemplateOutlet="container; context: { $implicit: item }"
        ></ng-template>
      }
      @case (FrameType.TEXT) {
        <ng-container
          *ngTemplateOutlet="text; context: { $implicit: item }"
        ></ng-container>
      }
    }
  }
</ng-template>

<!-- Container Template -->
<ng-template #container let-item>
  <app-container
    [item]="item"
    [appAssetDrop]="item"
    [id]="item.key!"
    (itemClick)="itemClick.emit($event)"
    (itemMouseOver)="itemMouseOver.emit($event)"
    (itemMouseOut)="itemMouseOut.emit($event)"
    (itemContextMenu)="itemContextMenu.emit($event)"
    [selectedFrameKey]="selectedFrameKey()"
    (itemTextContentChanged)="itemTextContentChanged.emit($event)"
  >
  </app-container>
</ng-template>

<!-- Text Template -->
<ng-template #text let-item>
  <app-text
    appEditableContent
    [item]="item"
    [appAssetDrop]="item"
    [id]="item.key!"
    (itemClick)="itemClick.emit($event)"
    (itemMouseOver)="itemMouseOver.emit($event)"
    (itemMouseOut)="itemMouseOut.emit($event)"
    (itemContextMenu)="itemContextMenu.emit($event)"
    (contentChanged)="itemTextContentChanged.emit($event)"
  >
  </app-text>
</ng-template>
