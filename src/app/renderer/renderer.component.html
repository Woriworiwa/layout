<div class="preview-container" [class.fullscreen]="isFullscreen()">
  <!-- Top Toolbar -->
  <div class="preview-toolbar">
    <div class="toolbar-section">
      <h2 class="toolbar-title">
        <i class="pi pi-eye mr-2"></i>
        Preview
      </h2>
    </div>

    <div class="toolbar-section toolbar-actions">
      <!-- Zoom Controls -->
      <div class="zoom-controls">
        <p-button
          icon="pi pi-minus"
          [text]="true"
          [rounded]="true"
          size="small"
          (onClick)="zoomOut()"
          pTooltip="Zoom Out"
          tooltipPosition="bottom" />
        <span class="zoom-label">{{ previewScale() }}%</span>
        <p-button
          icon="pi pi-plus"
          [text]="true"
          [rounded]="true"
          size="small"
          (onClick)="zoomIn()"
          pTooltip="Zoom In"
          tooltipPosition="bottom" />
        <p-button
          icon="pi pi-refresh"
          [text]="true"
          [rounded]="true"
          size="small"
          (onClick)="resetZoom()"
          pTooltip="Reset Zoom"
          tooltipPosition="bottom" />
      </div>

      <div class="toolbar-divider"></div>

      <!-- Action Buttons -->
      <p-button
        icon="pi pi-sync"
        [text]="true"
        [rounded]="true"
        size="small"
        (onClick)="refresh()"
        pTooltip="Refresh Preview"
        tooltipPosition="bottom" />

      <p-button
        [icon]="isFullscreen() ? 'pi pi-window-minimize' : 'pi pi-window-maximize'"
        [text]="true"
        [rounded]="true"
        size="small"
        (onClick)="toggleFullscreen()"
        [pTooltip]="isFullscreen() ? 'Exit Fullscreen' : 'Fullscreen'"
        tooltipPosition="bottom" />
    </div>
  </div>

  <!-- Main Content Area -->
  <div class="preview-content">
    <!-- Left Panel - Preview -->
    <div class="preview-panel">
      <div class="preview-wrapper">
        <div class="preview-frame" [style.transform]="'scale(' + previewScale() / 100 + ')'">
          <iframe
            [srcdoc]="code() | unsafeHtml"
            class="preview-iframe"></iframe>
        </div>
      </div>
    </div>

    <!-- Right Panel - Code -->
    <div class="code-panel">
      <!-- Code Tabs -->
      <div class="code-tabs">
        @for (tab of codeTabs; track tab.value) {
          <button
            class="code-tab"
            [class.active]="selectedCodeView() === tab.value"
            (click)="selectTab(tab.value)">
            <i [class]="tab.icon + ' mr-2'"></i>
            {{ tab.label }}
          </button>
        }
      </div>

      <!-- Code Content -->
      <div class="code-content">
        @switch (selectedCodeView()) {
          @case ('HTML') {
            <app-html-prism></app-html-prism>
          }
          @case ('CSS') {
            <app-css-prism [canvasItems]="items()"></app-css-prism>
          }
          @case ('JSON') {
            <app-json-prism></app-json-prism>
          }
        }
      </div>
    </div>
  </div>
</div>
